<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facture</title>
  
    <style>
        
    
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: Arial, sans-serif; 
        }

        .page-a4 {
            width: 210mm; 
            height: 297mm; 
            margin: 0;
            padding: 10mm; 
            box-sizing: border-box; 
            background-color: hsla(64, 100%, 50%, 0.3); 
            overflow: hidden; 
        }

        table.custom-table {
            border-collapse: collapse;
            width: 100%;
            font-size: 10px;
            border: 1px solid #000000;
            color: #000000;
            margin: 0;
            padding: 0;
        }
        

        @media print {
            body, html {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                background-color: transparent; 
            }
            .page-a4 {
                background-color: transparent; 
                border: none; 
                page-break-before: always; 
                height: 297mm; 
            }
            .no-print {
                display: none; 
            }
            #FactureContent {
                display: block; 
                width: 100%; 
                overflow: hidden; 
                height: 297mm; 
            }
            table.custom-table {
                width: 100%; 
            }

            .transition-container {
                width: 200px;
                background-color: #f0f0f0;
                overflow: hidden;
                transition: height 0.5s ease; 
                height: 20px; 
            }
    
            .transition-container.expanded {
                height: 21.38px; 
            }
            .container {
             position: relative;
}
 }
    </style>
</head>
<body>
    <div id="FactureContent" class="h-fit-content" *ngIf="showContent">
                <div class="page-a4" [style.backgroundColor]="backgroundColor" [style.fontSize.px]="fontSize" id="pageA4" >
                    <div class="controls no-print"  >
                        <label for="bg-color">Couleur de fond:</label>
                        <input type="color" id="bg-color" [value]="backgroundColor" (change)="changeBackgroundColor($event)">
                        <label for="font-size">Taille de police (px):</label>
                        <input type="number" id="font-size" [(ngModel)]="fontSize" min="8" max="36">
                    </div>
            <div class="container-big">
                     <div #exampleBox class="example-box" cdkDrag > 
                    <div class="drop-zone">
                        <div class="column" >
                            <div class="company-info-container" >
                                <div class="text-column" *ngIf="companyInfo && ClientInfo">
                                    <h6 style="font-size: 14px;  color: #000000; line-height: 1.2; margin-bottom: 4px;">
                                        {{ companyInfo.name }}
                                    </h6>
                                    <p style="line-height: 1.2; margin-bottom: 4px; color: #000000;">
                                        Adresse : {{ 444 }}
                                    </p>
                                    <p style="line-height: 1.2; margin-bottom: 4px; color: #000000;">
                                        Téléphone : {{ 4444 }}
                                    </p>
                                    <p *ngIf="companyInfo.email" style="line-height: 0.8; margin-bottom: 4px; color: #000000;">
                                        E-mail : {{ companyInfo.email }}
                                    </p>
                                    <p style="line-height: 0.8; margin-bottom: 4px; color: #000000;">
                                        CTVA : {{ 44 }}
                                    </p>
                                </div>
                            </div>
                         </div> 
                    </div>
                </div>
                
                <div #CompanyName class="CompanyName" cdkDrag> 
                    <div class="column" style="width: 50%;">
                        <div class="text-column" *ngIf="companyInfo && ClientInfo">
                            <p class="font-semibold" style="font-size: 16px; margin-bottom: 4px; color: #000000; margin-top: -20px;">
                                Facture N° {{ 444 }}
                            </p>
                            <p style="font-size: 14px; margin-top: -12px; color: #000000;">
                                Date : {{ currentDate | date:'dd - MM - yyyy' }}
                            </p>
                            <div class="company-info-container" style="height: 150px; width: 400px;">
                                <p class="font-semibold" style="font-size: 16px; color: #000000; margin-bottom: 8px;">
                                    Client : {{ 447 }}
                                </p>
                                <p style="line-height: 0.8; margin-bottom: 8px; color: #000000;">
                                    Adresse : {{ 74 }}
                                </p>
                                <p style="line-height: 0.8; margin-bottom: 8px;">
                                    Code client : {{ ClientInfo.clientcode }}
                                </p>
                                <p style="line-height: 0.8; margin-bottom: 8px; color: #000000;">
                                    Téléphone : {{ 4442 }}
                                </p>
                                <p style="line-height: 0.8; margin-bottom: 8px; color: #000000;">
                                    CTVA : {{ 22 }}
                                </p>
                            </div>
                        </div>
                    </div>
                 </div> 
            </div>
            <table #customtable class="custom-table" style="border-collapse: collapse; height: 300px; width: 95%; font-size: 10px; border: 1px solid #000000; overflow-y: auto; color: #000000;">
                <thead>
                    <tr>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Référence</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Désignation</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Quantité</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Prix U.HT</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">TVA %</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Remise %</th>
                        <th style="border: 1px solid #000000; padding: 4px; color: #000000;">Total HT</th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let item of factureItems" style="height: 20px; text-align: left; margin-top: 5px; padding-left: 10px;">
                        <td style="text-align: left; padding-left: 10px;">{{ item.reference }}</td>
                        <td style="text-align: left; padding-left: 10px;">{{ item.designation }}</td>
                        <td style="text-align: center; padding-left: 10px;">{{ item.quantity }}</td>
                        <td style="text-align: right; padding-left: 10px;">{{ item.pricePerUnitHT }}</td>
                        <td style="text-align: right; padding-left: 10px;">{{ item.tva }}</td>
                        <td style="text-align: right; padding-left: 10px;">{{ item.remise }}</td>
                        <td style="text-align: right; padding-left: 10px;">{{ item.total }}</td>
                    </tr>
                </tbody>
            </table>
            <div class="container-big">
                <div class="column">
                     <div #exampleebox class="examplee-box" cdkDrag > 
                        <table class="custom-table" style="border-collapse: collapse; height: 10px; width: 500px; font-size: 14px; border: 1px solid #000000; overflow-y: auto; color: #000000;">
                            <thead>
                                <tr>
                                    <th style="border: 1px solid #000000; padding: 4px; color: #000000;">TAXE</th>
                                    <th style="border: 1px solid #000000; padding: 4px; color: #000000;">BASE</th>
                                    <th style="border: 1px solid #000000; padding: 4px; color: #000000;">TAUX</th>
                                    <th style="border: 1px solid #000000; padding: 4px; color: #000000;">MONTANT</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr style="height: 15px; text-align: center;">
                                    <td style="border-right: 1px solid #000000; padding: 4px; color: #000000;">TVA</td>
                                    <td style="border-right: 1px solid #000000; padding: 4px; color: #000000;">{{ 1 - totalRemise }}</td>
                                    <td style="border-right: 1px solid #000000; padding: 4px; color: #000000;">{{14}}%</td>
                                    <td>{{ 44 }}</td>
                                </tr>
                            </tbody>
                        </table>
                     </div>   
                      </div>
                      <div class="container">
                        <div class="box" cdkDrag>
                            <p class="remark-label">Remarque :</p>
                        
                        <div class="textarea-container">
                            <div class="controls no-print"  >
                            <input type="color" id="text-color" (input)="changeTextColor($event)" [value]="textColor">
                            </div>
                            <textarea id="story" name="story" rows="5" cols="33" placeholder="Écrivez votre remarque ici..." [style.color]="textColor"></textarea>
                        </div>
                    </div>
                        
                        



                        <div class="examplee-box"> 
                            <div class="column" style="height: 150px; width: 500px;">
                                <div class="info-section1">
                                    <p style="margin-bottom: 1px; font-weight: bold; color: #000000;">Total HTVA :</p>
                                    <p style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{44}} TND</p>
                                    <p style="margin-bottom: 1px; font-weight: bold; color: #000000;">Total Remise :</p>
                                    <p style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{224}} TND</p>
                                    <p style="margin-bottom: 1px; font-weight: bold; color: #000000;">Total TVA :</p>
                                    <p style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{42}} TND</p>
                                    <p style="margin-bottom: 1px; font-weight: bold; color: #000000;">Timbre :</p>
                                    <p style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{7775}} TND</p>
                                    <p *ngIf="sumoffodec" style="margin-bottom: 1px; font-weight: bold; color: #000000;">Fodec:</p>
                                    <p *ngIf="sumoffodec" style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{78}} TND</p>
                                    <p style="margin-bottom: 1px; font-weight: bold; color: #000000;">Net à payer :</p>
                                    <p *ngIf="!consult" style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{5 - totalRemise}} TND</p>
                                    <p *ngIf="consult" style="margin-bottom: 1px; font-weight: medium; color: #000000; text-align: right; margin-top: -19px;">{{5}} TND</p>
                                </div>
                            </div>
                        </div>
                    
                    
                    <div class="box" cdkDrag >
                        <h4 style="text-align: center;  margin-top: 30px">Cachet & signature</h4>
                     </div> 
                </div>
             </div>
        </div>      
        <p-button class="no-print" (click)="printInvoice()" icon="pi pi-print" label="Imprimer"></p-button>
    </div>
</body>
</html>